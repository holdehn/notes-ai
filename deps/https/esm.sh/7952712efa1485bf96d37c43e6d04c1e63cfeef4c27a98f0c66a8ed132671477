/* esm.sh - esbuild bundle(grad-school@0.0.5) deno production */
var a=function(e){return e.children=e.children||[],e._cache=e._cache||{},e.props=e.props||{},e._cache.parents=e._cache.parents||[],e._cache.children=e._cache.children||[],e},O=/^ *(#|\/\/)/,v=function(e){let r=e.trim().split(/->/),t=[];r.forEach(n=>{t=t.concat(function(s){if(!(s=s.trim()))return null;if(/^\[/.test(s)&&/\]$/.test(s)){let c=(s=(s=s.replace(/^\[/,"")).replace(/\]$/,"")).split(/,/);return c=c.map(h=>h.trim()).filter(h=>h),c=c.map(h=>a({id:h})),c}return[a({id:s})]}(n))}),t=t.filter(n=>n);let i=t[0];for(let n=1;n<t.length;n+=1)i.children.push(t[n]),i=t[n];return t[0]},l=(e,r)=>{let t=[],i=[e];for(;i.length>0;){let n=i.pop();t.push(n),n.children&&n.children.forEach(s=>{r&&r(n,s),i.push(s)})}return t},y=e=>Object.prototype.toString.call(e)==="[object Array]",j=e=>(e=e||"").trim(),P=function(e=[]){return typeof e=="string"?function(t){let i=t.split(/\r?\n/),n=[];i.forEach(c=>{if(!c.trim()||O.test(c))return;let h=(o=>{let u=/^( {2}|\t)/,p=0;for(;u.test(o);)o=o.replace(u,""),p+=1;return p})(c);n.push({indent:h,node:v(c)})});let s=function(c){let h={children:[]};return c.forEach((o,u)=>{o.indent===0?h.children=h.children.concat(o.node):c[u-1]&&function(p,f){let w=p[f].indent;for(;f>=0;f-=1)if(p[f].indent<w)return p[f];return p[0]}(c,u).node.children.push(o.node)}),h}(n);return s=a(s),s}(e):y(e)?function(t){let i={};t.forEach(s=>{i[s.id]=s});let n=a({});return t.forEach(s=>{if((s=a(s)).parent)if(i.hasOwnProperty(s.parent)){let c=i[s.parent];delete s.parent,c.children.push(s)}else console.warn(`[Grad] - missing node '${s.parent}'`);else n.children.push(s)}),n}(e):(l(r=e).forEach(a),r);var r},S=e=>"\x1B[31m"+e+"\x1B[0m",k=e=>"\x1B[2m"+e+"\x1B[0m",_=function(e,r){let t="-> ";r&&(t=k("\u2192 "));let i="";return l(e).forEach((n,s)=>{let c=n.id||"";if(r&&(c=S(c)),s===0&&!n.id)return;let h=n._cache.parents.length;i+="    ".repeat(h)+t+c+`
`}),i},b=function(e){let r=l(e);r.forEach(i=>{delete(i=Object.assign({},i)).children});let t=r[0];return t&&!t.id&&Object.keys(t.props).length===0&&r.shift(),r},m={text:_,txt:_,array:b,flat:b},E=function(e,r){return r==="nested"||r==="json"?e:r==="debug"?(console.log(_(e,!0)),null):m.hasOwnProperty(r)?m[r](e):e},g=e=>{l(e,(r,t)=>{r.id&&(r._cache.parents=r._cache.parents||[],t._cache.parents=r._cache.parents.concat([r.id]))})},x=(e,r)=>(Object.keys(r).forEach(t=>{if(r[t]instanceof Set){let i=e[t]||new Set;e[t]=new Set([...i,...r[t]])}else if((i=>i&&typeof i=="object"&&!Array.isArray(i))(r[t])){let i=e[t]||{};e[t]=Object.assign({},r[t],i)}else y(r[t])?e[t]=r[t].concat(e[t]||[]):e[t]===void 0&&(e[t]=r[t])}),e),A=/\//,d=class{constructor(r={}){Object.defineProperty(this,"json",{enumerable:!1,value:r,writable:!0})}get children(){return this.json.children}get id(){return this.json.id}get found(){return this.json.id||this.json.children.length>0}props(r={}){let t=this.json.props||{};return typeof r=="string"&&(t[r]=!0),this.json.props=Object.assign(t,r),this}get(r){if(r=j(r),!A.test(r)){let i=this.json.children.find(n=>n.id===r);return new d(i)}let t=((i,n)=>{let s=(c=>typeof c!="string"?c:(c=c.replace(/^\//,"")).split(/\//))(n=n||"");for(let c=0;c<s.length;c+=1){let h=i.children.find(o=>o.id===s[c]);if(!h)return null;i=h}return i})(this.json,r)||a({});return new d(t)}add(r,t={}){if(y(r))return r.forEach(n=>this.add(j(n),t)),this;r=j(r);let i=a({id:r,props:t});return this.json.children.push(i),new d(i)}remove(r){return r=j(r),this.json.children=this.json.children.filter(t=>t.id!==r),this}nodes(){return l(this.json).map(r=>(delete(r=Object.assign({},r)).children,r))}cache(){return(r=>{let t=l(r,(n,s)=>{n.id&&(n._cache.parents=n._cache.parents||[],n._cache.children=n._cache.children||[],s._cache.parents=n._cache.parents.concat([n.id]))}),i={};t.forEach(n=>{n.id&&(i[n.id]=n)}),t.forEach(n=>{n._cache.parents.forEach(s=>{i.hasOwnProperty(s)&&i[s]._cache.children.push(n.id)})}),r._cache.children=Object.keys(i)})(this.json),this}list(){return l(this.json)}fillDown(){var r;return r=this.json,l(r,(t,i)=>{i.props=x(i.props,t.props)}),this}depth(){g(this.json);let r=l(this.json),t=r.length>1?1:0;return r.forEach(i=>{if(i._cache.parents.length===0)return;let n=i._cache.parents.length+1;n>t&&(t=n)}),t}out(r){return g(this.json),E(this.json,r)}debug(){return g(this.json),E(this.json,"debug"),this}},$=function(e){let r=P(e);return new d(r)};$.prototype.plugin=function(e){e(this)};export{$ as default};
//# sourceMappingURL=grad-school.mjs.map